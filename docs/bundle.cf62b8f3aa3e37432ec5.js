(()=>{"use strict";const e=new Date,t=e=>String(e).padStart(2,"0"),n=`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}`,a={ui:{modals:{newAppointmentOpen:!1,calendarOpen:!1},selectedDateISO:"",calendar:{year:e.getFullYear(),month:e.getMonth(),selectedDateISO:n}},data:{appointments:[]}},o=e=>String(e).padStart(2,"0");function r(e){return`${e.getFullYear()}-${o(e.getMonth()+1)}-${o(e.getDate())}`}function i(e,t,n){const a=new Date(e,t+n,1);return{year:a.getFullYear(),month:a.getMonth()}}function c(e,t){const n=e.ui.calendar;switch(t.type){case"CAL_PREV":{const t=i(n.year,n.month,-1);return{...e,ui:{...e.ui,calendar:{...n,...t}}}}case"CAL_NEXT":{const t=i(n.year,n.month,1);return{...e,ui:{...e.ui,calendar:{...n,...t}}}}case"CAL_SELECT_DATE":return{...e,ui:{...e.ui,calendar:{...n,selectedDateISO:t.payload.dateISO}}};default:return e}}const d=e=>!e||""===String(e).trim(),s=e=>String(e).padStart(2,"0"),l=e=>`${e.getFullYear()}-${s(e.getMonth()+1)}-${s(e.getDate())}`,u=JSON.parse('{"services":[{"id":"bath-groom","label":"Banho e tosa"},{"id":"vet-consult","label":"Consulta veterinária"},{"id":"vaccination","label":"Vacinação"},{"id":"deworming","label":"Vermifugação"},{"id":"flea-tick","label":"Controle de pulgas e carrapatos"}],"appointments":[{"id":"1769225982228-ef91ef0d3477a8","petType":"cat","petName":"Nina","ownerName":"Karol","service":"vet-consult","time":"15:30","dateISO":"2026-02-24"}]}'),m="/api",p="undefined"!=typeof window,f=p&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),g="auqmia:services",y="auqmia:appointments";function h(e){return Array.isArray(e)?e.map(e=>e&&"object"==typeof e?{...e}:e):[]}const S=function(){if(!p||!window.localStorage)return!1;try{const e="__auqmia_storage_test__";return window.localStorage.setItem(e,"1"),window.localStorage.removeItem(e),!0}catch(e){return!1}}(),v=h(u?.services),b=h(u?.appointments);function E(e,t){if(!S)return h(t);try{const n=window.localStorage.getItem(e);if(!n){const n=h(t);return window.localStorage.setItem(e,JSON.stringify(n)),n}const a=JSON.parse(n);if(Array.isArray(a))return a}catch(e){}return h(t)}function _(e,t){if(S)try{window.localStorage.setItem(e,JSON.stringify(t))}catch(e){}}const w={services:E(g,v),appointments:E(y,b)};function O(e,t){return e.time.localeCompare(t.time)}const A={"bath-groom":{icon:"solar:bath-linear"},"vet-consult":{icon:"mdi:stethoscope"},vaccination:{icon:"solar:syringe-linear"},deworming:{icon:"mdi:pill"},"flea-tick":{icon:"mdi:bug"}},N={};function I(e){const[t,n]=e.split("-");return{year:Number(t),month:Number(n)-1,selectedDateISO:e}}function C(e,t){if("ADD_APPOINTMENT"!==t.type&&"REMOVE_APPOINTMENT"!==t.type)return e;const n="ADD_APPOINTMENT"===t.type?[...e.data.appointments,t.payload.appointment]:e.data.appointments.filter(e=>e.id!==t.payload.id);return{...e,data:{...e.data,appointments:n}}}function D(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function T(e,t){const n=document.createElement("li");n.className="empty-state",n.textContent=`Sem agendamentos (${t})`,e.appendChild(n)}function L(e){const t=document.createElement("li");t.className=`appt-card appt-card--${e.petType||"dog"}`;const n=document.createElement("div");n.className="appt-card__top";const a=document.createElement("div");a.className="appt-card__identity";const o=document.createElement("div");o.className=`appt-card__avatar appt-card__avatar--${e.petType||"dog"}`;const r=document.createElement("iconify-icon");r.setAttribute("icon","cat"===e.petType?"solar:cat-linear":"mdi:dog"),r.setAttribute("aria-hidden","true"),r.className="appt-card__avatar-icon",o.appendChild(r);const i=document.createElement("div"),c=document.createElement("h3");c.className="appt-card__pet",c.textContent=e.petName;const d=document.createElement("p");d.className="appt-card__owner",d.textContent=e.ownerName,i.append(c,d),a.append(o,i);const s=document.createElement("span");s.className="appt-card__time",s.textContent=e.time,n.append(a,s);const l=document.createElement("div");l.className="appt-card__footer";const u=document.createElement("div");u.className="appt-card__service";const m=(p=e.service,A[p]?A[p]:{icon:"solar:scissors-linear"});var p;const f=document.createElement("iconify-icon");f.setAttribute("icon",m.icon),f.setAttribute("aria-hidden","true"),f.className="appt-card__service-icon";const g=document.createElement("span");g.className="appt-card__service-label",g.textContent=N[e.service]?.label||e.service||"Service",u.append(f,g);const y=document.createElement("div");y.className="appt-card__actions";const h=document.createElement("button");h.type="button",h.className="appt-card__action",h.setAttribute("aria-label","Delete"),h.dataset.action="delete-appointment",h.dataset.appointmentId=e.id;const S=document.createElement("iconify-icon");return S.setAttribute("icon","solar:trash-bin-trash-linear"),S.setAttribute("aria-hidden","true"),h.appendChild(S),y.appendChild(h),l.append(u,y),t.append(n,l),t}function q(e){const t=document.getElementById("modal-new"),n=t?.querySelector("form.form");if(!n)return;const a=n.querySelector("[data-submit-icon]"),o=n.querySelector(".form__submit"),r=n.elements?.service,i=n.elements?.dateISO,c=document.querySelector("[data-notice]"),s=c?.querySelector("[data-notice-message]");let u=null,p=!1,h=null,S=null;const v=["petType","petName","ownerName","service","time","dateISO"];function b(e){n.querySelectorAll("[data-error-for]").forEach(t=>{const n=t.getAttribute("data-error-for");t.textContent=e[n]||""})}function E(){c&&(c.dataset.open="false",u&&(clearTimeout(u),u=null),setTimeout(()=>{c.hidden=!0},250))}function A(e){c&&s&&e&&(p||(s.textContent=e,c.hidden=!1,requestAnimationFrame(()=>{c.dataset.open="true"}),u&&clearTimeout(u),u=setTimeout(E,1500),h&&clearTimeout(h),p=!0,h=setTimeout(()=>{p=!1},1500),S&&clearTimeout(S),S=setTimeout(()=>{b({}),v.forEach(e=>P(e,!1)),j(),S=null},1500)))}function q(e){const t=Object.values(e).filter(Boolean);return t.length?t.join(" • "):""}async function M(e,t){const n=await fetch(e,t);if(!n.ok)throw new Error("Request failed");return n.json()}function $(t){if(!r||!Array.isArray(t))return;Object.keys(N).forEach(e=>delete N[e]);const n=document.createDocumentFragment();for(t.forEach(e=>{if(!e||!e.id||!e.label)return;N[e.id]={label:e.label};const t=document.createElement("option");t.value=e.id,t.textContent=e.label,n.appendChild(t)});r.options.length>1;)r.remove(1);r.appendChild(n),F(e.getState())}function x(t){Array.isArray(t)&&e.update(e=>({...e,data:{...e.data,appointments:t}}))}async function k(){try{const e=f?await M(`${m}/appointments`):w.appointments;if(!Array.isArray(e))throw new Error("Invalid appointments payload");f||(w.appointments=e,_(y,e)),x(e)}catch(e){x(w.appointments)}}function P(e,t){const a="petType"===e?n.querySelector('[data-field="petType"]'):n.elements?.[e];a&&"function"==typeof a.setAttribute&&(t?a.setAttribute("aria-invalid","true"):a.removeAttribute("aria-invalid"))}function F(e){(function(e){const t=e.ui.calendar.selectedDateISO,n={morning:document.querySelector('[data-slot="morning"]'),afternoon:document.querySelector('[data-slot="afternoon"]'),night:document.querySelector('[data-slot="night"]')};if(!n.morning||!n.afternoon||!n.night)return;Object.values(n).forEach(D);const a=e.data.appointments.filter(e=>e.dateISO===t).slice().sort(O),o={morning:[],afternoon:[],night:[]};a.forEach(e=>o[function(e){const[t]=e.split(":").map(Number);return t<12?"morning":t<18?"afternoon":"night"}(e.time)].push(e)),o.morning.length?o.morning.forEach(e=>n.morning.appendChild(L(e))):T(n.morning,"manhã"),o.afternoon.length?o.afternoon.forEach(e=>n.afternoon.appendChild(L(e))):T(n.afternoon,"tarde"),o.night.length?o.night.forEach(e=>n.night.appendChild(L(e))):T(n.night,"noite")})(e),e.ui.modals.newAppointmentOpen&&i&&!i.value&&(i.value=e.ui.calendar.selectedDateISO)}function j(){const e=n.querySelector('input[name="petType"]:checked'),t=e?.dataset?.icon,r=e?.value;if(o&&(o.classList.remove("form__submit--dog","form__submit--cat"),"dog"===r&&o.classList.add("form__submit--dog"),"cat"===r&&o.classList.add("form__submit--cat")),a){if(!t)return a.hidden=!0,void a.removeAttribute("icon");a.setAttribute("icon",t),a.hidden=!1}}F(e.getState()),e.subscribe(F),j(),async function(){if(r){r.disabled=!0;try{const e=f?await M(`${m}/services`):w.services;if(!Array.isArray(e))throw new Error("Invalid services payload");f||(w.services=e,_(g,e)),$(e)}catch(e){$(w.services)}finally{r.disabled=!1}}}(),k(),i&&i.addEventListener("change",()=>{i.value&&e.update(e=>{return t=e,n=i.value,{...t,ui:{...t.ui,calendar:{...t.ui.calendar,...I(n)}}};var t,n})}),n.addEventListener("change",e=>{const t=e.target;t instanceof HTMLInputElement&&"petType"===t.name&&j()}),n.addEventListener("submit",async t=>{t.preventDefault();const a=new FormData(n),o={petType:String(a.get("petType")||""),petName:String(a.get("petName")||""),ownerName:String(a.get("ownerName")||""),service:String(a.get("service")||""),time:String(a.get("time")||""),dateISO:String(a.get("dateISO")||e.getState().ui.calendar.selectedDateISO||"")},{ok:r,errors:i}=function(e){const t={};if(["dog","cat"].includes(e.petType)||(t.petType="Selecione o tipo"),d(e.petName)&&(t.petName="Informe o nome do pet"),d(e.ownerName)&&(t.ownerName="Informe o nome do tutor"),d(e.service)&&(t.service="Selecione o serviço"),d(e.time)&&(t.time="Informe o horário"),d(e.dateISO)&&(t.dateISO="Informe a data"),!t.dateISO){const n=l(new Date);e.dateISO<n&&(t.dateISO="Data já passou")}if(!t.time&&!t.dateISO){const n=l(new Date);if(e.dateISO===n){const[n,a]=String(e.time).split(":").map(Number);if(Number.isFinite(n)&&Number.isFinite(a)){const e=new Date,o=new Date;o.setHours(n,a,0,0),o.getTime()<e.getTime()&&(t.time="Horário já passou")}}}return{ok:0===Object.keys(t).length,errors:t}}(o);if(!r)return b(i),Object.keys(i).forEach(e=>P(e,!0)),void A(q(i));b({}),v.forEach(e=>P(e,!1));const c=e.getState().data.appointments.some(e=>e.dateISO===o.dateISO&&e.time===o.time);if(c){const e={time:"Horário já ocupado"};return b(e),P("time",!0),void A(q(e))}const s={id:`${Date.now()}-${Math.random().toString(16).slice(2)}`,...o};try{const t=await async function(e){if(f)return M(`${m}/appointments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});const t=[...w.appointments,e];return w.appointments=t,_(y,t),e}(s);!function(t){e.update(e=>{return n=C(e,{type:"ADD_APPOINTMENT",payload:{appointment:t}}),{...n,ui:{...n.ui,modals:{calendarOpen:!1,newAppointmentOpen:!1}}};var n})}(t)}catch(e){return void A("Unable to save appointment")}n.reset(),j()}),document.addEventListener("click",async t=>{const n=t.target;if(!(n instanceof HTMLElement))return;const a=n.closest('[data-action="delete-appointment"]');if(!a)return;t.preventDefault(),t.stopPropagation();const o=a.getAttribute("data-appointment-id");if(o){!function(t){e.update(e=>C(e,{type:"REMOVE_APPOINTMENT",payload:{id:t}}))}(o);try{await async function(e){if(f){if(!(await fetch(`${m}/appointments/${encodeURIComponent(e)}`,{method:"DELETE"})).ok)throw new Error("Failed to delete");return}const t=w.appointments.filter(t=>t.id!==e);w.appointments=t,_(y,t)}(o)}catch(e){A("Unable to delete appointment"),k()}}})}const M=function(e){let t=e;const n=new Set,a=e=>{t=e,n.forEach(e=>e(t))};return{getState:()=>t,setState:a,update:e=>a(e(t)),subscribe:e=>(n.add(e),()=>n.delete(e))}}(a);document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("submit",e=>{const t=e.target?.closest?.("form");t&&t.classList?.contains("form")&&e.preventDefault()},!0),function(){const e=document.getElementById("loader-screen"),t=document.getElementById("app-content");if(!e||!t)return;const n=performance.now(),a=document.getElementById("loader-progress"),o=document.getElementById("loader-percentage"),r=document.getElementById("cat-runner"),i=document.getElementById("dog-runner");requestAnimationFrame(function c(d){const s=d-n,l=Math.min(s/2e3,1),u=Math.floor(100*l);o&&(o.textContent=`${u}%`),a&&(a.style.width=`${u}%`),r&&(r.style.left=15+85*l+"%"),i&&(i.style.left=85*l+"%"),l<1?requestAnimationFrame(c):setTimeout(()=>{e.classList.add("loader-hidden"),t.classList.add("loaded"),document.body.classList.remove("is-loading")},400)})}(),function(e){const t=document.querySelector("[data-overlay]"),n=document.getElementById("modal-calendar"),a=document.getElementById("modal-new"),o=new Map;let r=null,i=null;function c(t){e.update(e=>function(e,t){switch(e.ui.modals,t.type){case"OPEN_CALENDAR":return{...e,ui:{...e.ui,modals:{calendarOpen:!0,newAppointmentOpen:!1}}};case"OPEN_NEW":return{...e,ui:{...e.ui,modals:{calendarOpen:!1,newAppointmentOpen:!0}}};case"CLOSE_ALL":return{...e,ui:{...e.ui,modals:{calendarOpen:!1,newAppointmentOpen:!1}}};default:return e}}(e,t))}function d(e,t){if(!e)return;const n=o.get(e);if(n&&(clearTimeout(n),o.delete(e)),t)return e.hidden=!1,e.setAttribute("aria-hidden","false"),void requestAnimationFrame(()=>{e.dataset.open="true"});e.dataset.open="false",e.setAttribute("aria-hidden","true");const a=setTimeout(()=>{e.hidden=!0,o.delete(e)},300);o.set(e,a)}function s(e){const{calendarOpen:o,newAppointmentOpen:c}=e.ui.modals;d(t,o||c),d(n,o),d(a,c),document.querySelectorAll('[data-action="open-calendar"]').forEach(e=>e.setAttribute("aria-expanded",String(o))),document.querySelectorAll('[data-action="open-new-appointment"]').forEach(e=>e.setAttribute("aria-expanded",String(c)));const s=o?"calendar":c?"new":null;if(s&&s!==i){const e="calendar"===s?n:a;e?.querySelector(".modal__close")?.focus()}!s&&i&&(r?.focus?.(),r=null),i=s}s(e.getState()),e.subscribe(s),document.addEventListener("click",e=>{const t=e.target.closest("[data-action]");if(!t)return;const n=t.dataset.action;"open-calendar"===n&&(r=document.activeElement,c({type:"OPEN_CALENDAR"})),"open-new-appointment"===n&&(r=document.activeElement,c({type:"OPEN_NEW"})),"close-all"===n&&c({type:"CLOSE_ALL"})}),document.addEventListener("keydown",t=>{if("Escape"!==t.key)return;const{calendarOpen:n,newAppointmentOpen:a}=e.getState().ui.modals;(n||a)&&c({type:"CLOSE_ALL"})}),document.addEventListener("submit",e=>{e.target.closest(".form")&&e.preventDefault()})}(M),function(e){const t=document.querySelector("[data-calendar-month]"),n=document.querySelector("[data-calendar-year]"),a=document.querySelector("[data-calendar-grid]"),o=document.querySelector("[data-calendar-count]");function i(t){e.update(e=>c(e,t))}function d(e){const{year:i,month:c,selectedDateISO:d}=e.ui.calendar;if(t.textContent=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][c],n.textContent=String(i),o){const t=(e.data.appointments||[]).filter(e=>{const[t,n]=e.dateISO.split("-").map(Number);return t===i&&n===c+1}).length;o.textContent=String(t)}const s=function(e,t){const n=new Date(e,t,1).getDay(),a=new Date(e,t,1-n),o=[];for(let e=0;e<42;e++){const n=new Date(a);n.setDate(a.getDate()+e),o.push({date:n,dateISO:r(n),day:n.getDate(),inMonth:n.getMonth()===t})}return o}(i,c);a.innerHTML="",e.ui.calendar.selectedDateISO;const l=(()=>{const e=new Date,t=e=>String(e).padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}`})();s.forEach(t=>{const n=document.createElement("button");n.type="button",n.className="calendar__day",n.dataset.date=t.dateISO,n.setAttribute("role","gridcell"),t.inMonth||(n.setAttribute("aria-disabled","true"),n.disabled=!0),t.dateISO===d&&n.classList.add("calendar__day--selected"),t.dateISO===l&&n.classList.add("calendar__day--today"),n.textContent=String(t.day);const{hasDog:o,hasCat:r}=function(e,t){const n=(e.data.appointments||[]).filter(e=>e.dateISO===t);return{hasDog:n.some(e=>"dog"===e.petType),hasCat:n.some(e=>"cat"===e.petType)}}(e,t.dateISO);if(o||r){const e=document.createElement("div");if(e.className="calendar__dots",o){const t=document.createElement("span");t.className="calendar__dot calendar__dot--dog",t.setAttribute("aria-hidden","true"),e.appendChild(t)}if(r){const t=document.createElement("span");t.className="calendar__dot calendar__dot--cat",t.setAttribute("aria-hidden","true"),e.appendChild(t)}n.appendChild(e)}a.appendChild(n)})}t&&n&&a&&(d(e.getState()),e.subscribe(d),document.addEventListener("click",t=>{const n=t.target.closest("[data-action]");if(n){const e=n.dataset.action;"calendar-prev"===e&&i({type:"CAL_PREV"}),"calendar-next"===e&&i({type:"CAL_NEXT"})}const a=t.target.closest(".calendar__day[data-date]");if(a&&!a.disabled){const t=a.dataset.date;e.update(e=>{const n=c(e,{type:"CAL_SELECT_DATE",payload:{dateISO:t}});return{...n,ui:{...n.ui,modals:{...n.ui.modals,calendarOpen:!1}}}})}}))}(M),q(M),function(){const e=document.querySelector(".app-header__date time");if(!e)return;const t=new Date;e.dateTime=r(t),e.textContent=t.toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"long"}).replace(/^./,e=>e.toUpperCase()).replace(/ de ([a-záéíóúãõç])/g,(e,t)=>` de ${t.toUpperCase()}`)}(),"undefined"!=typeof window&&window.particlesJS&&document.getElementById("particles-js")&&window.particlesJS("particles-js",{particles:{number:{value:30,density:{enable:!0,value_area:800}},color:{value:["#22d3ee","#e879f9"]},shape:{type:["circle","image"],image:{src:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='%23ffffff' d='M18.37 8.51c.56-.33 1.65-.46 2.54.07 1.06.64 1.57 2.2 1.01 2.84-.56.64-1.96.69-3.02.05-1.06-.63-1.1-2.62-.53-2.96zm-4.72-3.65c.82-.47 2.09-.13 2.84 1.18.76 1.31.28 3.09-.54 3.55-.83.47-2.1.14-2.85-1.18-.76-1.31-.28-3.09.55-3.55zm-5.7.07c.86-.26 2.06.4 2.55 1.83.49 1.44-.1 2.98-.96 3.24-.85.26-2.06-.4-2.55-1.83-.49-1.44.1-2.98.96-3.24zm-5.2 5.7c.56-.25 1.69-.09 2.38.74.68.83.55 2.43-.01 2.68-.56.26-1.86-.11-2.54-.94-.68-.83-.4-2.23.17-2.48zM8.87 13.84c2.08-1.02 4.82-.56 6.45.92 1.94 1.76 1.71 5.59-.19 7.66-1.73 1.88-5.2 2.58-7.9.15-2.46-2.21-1.84-5.89.09-7.66 1.42-1.3 3.82-1.55 5.95-1.07z'/%3E%3C/svg%3E",width:100,height:100}},opacity:{value:.4,random:!0,anim:{enable:!0,speed:1,opacity_min:.1,sync:!1}},size:{value:8,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#6366f1",opacity:.15,width:1},move:{enable:!0,speed:1.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"bubble"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{bubble:{distance:200,size:12,duration:2,opacity:.8,speed:3},push:{particles_nb:4}}},retina_detect:!0})})})();
//# sourceMappingURL=bundle.cf62b8f3aa3e37432ec5.js.map